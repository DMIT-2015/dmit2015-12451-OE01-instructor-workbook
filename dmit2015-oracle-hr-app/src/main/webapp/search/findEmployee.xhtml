<!-- This is a Faces composition page that extends the layout template -->
<ui:composition
        template="/WEB-INF/faces-templates/layout.xhtml"
        xmlns:ui="jakarta.faces.facelets"
        xmlns:h="jakarta.faces.html"
        xmlns:f="jakarta.faces.core"
        xmlns:p="primefaces"
        xmlns:o="http://omnifaces.org/ui">

    <!-- Page metadata for title, description, and keywords -->
    <ui:param name="title" value="findEmployee"/>

    <!-- Define main content for the page -->
    <ui:define name="maincontent">
        <div class="card">
            <h1 role="heading" aria-level="1">Find Employees</h1>
            <h:form id="findEmployee_form" role="form">
                <p:panel header="Welcome to Find Employees">
                    <!-- Add page-specific content here, e.g., PrimeFaces components -->
                    <div class="field">
                        <p:outputLabel for="@next">Department Name</p:outputLabel>
<p:autoComplete id="selectDepartment"
                value="#{employeeQueryView.selectedDepartment}"
                completeMethod="#{employeeQueryView.completeDepartment}"
                var="dept" itemLabel="#{dept.departmentName}" itemValue="#{dept}"
                converter="#{departmentConverter}"
                forceSelection="true"
                scrollHeight="350"
                />
                    </div>
                    <p:commandButton id="searchButton"
                                     value="Search"
                                     actionListener="#{employeeQueryView.onSubmit()}"
                                     update=":growl :messages dataTable"/>

                    <p:commandButton id="clearButton"
                                     value="Clear"
                                     actionListener="#{employeeQueryView.onClear()}"
                                     update="dataTable @form" />

                    <p:dataTable id="dataTable"
                                 value="#{employeeQueryView.queryResults}"
                                 var="it"
                                 rowKey="#{it.id}">
                        <p:column headerText="Employee Name">
                            <h:outputText value="#{it.fullName}" />
                        </p:column>

                        <p:column headerText="Job Title">
                            <h:outputText value="#{it.job.jobTitle}" />
                        </p:column>

                        <p:column headerText="Salary">
                            <h:outputText value="#{it.salary}">
                                <f:convertNumber type="currency" />
                            </h:outputText>
                        </p:column>

                        <p:column headerText="Department Name">
                            <h:outputText value="#{it.department.departmentName}" />
                        </p:column>

                        <p:column headerText="Manager">
                            <h:outputText value="#{(it.manager == null ? 'No Manager' : it.manager.fullName)}" />
                        </p:column>

                    </p:dataTable>

                </p:panel>
            </h:form>
        </div>
    </ui:define>

</ui:composition>